<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>IA QUANT TERMINAL</title>
    <style>
        body { background: #0b0e11; color: #eaecef; font-family: 'Segoe UI', sans-serif; margin: 0; }
        .header { display: flex; gap: 30px; padding: 20px; background: #181a20; border-bottom: 1px solid #2b2f36; }
        .metric-box { display: flex; flex-direction: column; }
        .label { color: #848e9c; font-size: 12px; }
        .value { color: #00ffcc; font-size: 20px; font-weight: bold; }
        #terminal-log { background: #000; height: 200px; padding: 15px; overflow-y: scroll; font-family: monospace; color: #00ff00; }
    </style>
</head>
<body>
    <div class="header">
        <div class="metric-box">
            <span class="label">PREÇO BTC/USDT</span>
            <span id="price" class="value">0.00</span>
        </div>
        <div class="metric-box">
            <span class="label">SINAL IA</span>
            <span id="signal" class="value" style="color: #f0b90b;">ANALISANDO...</span>
        </div>
    </div>

    <div id="tradingview_widget" style="height: 500px;"></div>

    <div id="terminal-log">
        > Iniciando motor de validação...<br>
    </div>

    <script>
        async function refreshData() {
            try {
                const res = await fetch('http://127.0.0.1:8000/api/market');
                const data = await res.json();
                
                // Atualiza apenas os textos, sem recarregar a página
                document.getElementById('price').innerText = `$ ${data.price}`;
                document.getElementById('signal').innerText = data.ai_signal;
                
                const log = document.getElementById('terminal-log');
                log.innerHTML += `[${new Date().toLocaleTimeString()}] Preço atualizado: ${data.price}<br>`;
                log.scrollTop = log.scrollHeight;
            } catch (err) {
                console.error("Erro ao conectar com o motor Python");
            }
        }

        // Roda a cada 1 segundo (Tempo Real de verdade)
        setInterval(refreshData, 1000);
    </script>
</body>
</html>
